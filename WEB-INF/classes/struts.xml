<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
	"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
	"http://struts.apache.org/dtds/struts-2.3.dtd">

<struts>
	<constant name="struts.custom.i18n.resources" value="wirich" />
	<!-- 20M -->
	<constant name="struts.multipart.maxSize" value="20480000" />
	<package name="wirichJsp" extends="struts-default">
		<interceptors>
			<interceptor name="i18n"
				class="com.opensymphony.xwork2.interceptor.I18nInterceptor" />
			<interceptor name="wirichInterceptor" class="WirichAuthInterceptor" />
			<interceptor-stack name="wirichDefaultInterceptor">
				<interceptor-ref name="wirichInterceptor" />
				<interceptor-ref name="defaultStack" />
			</interceptor-stack>
		</interceptors>
		<default-interceptor-ref name="wirichDefaultInterceptor" />
		<global-results>
			<result name="login" type="redirect">/login.html</result>
			<result name="error">/error.html</result>
		</global-results>
	</package>

	<package name="wirich" extends="json-default">
		<interceptors>
			<interceptor name="wirichJsonInterceptor" class="WirichAuthJSONInterceptor" />
			<interceptor-stack name="wirichJsonInterceptor">
				<interceptor-ref name="wirichJsonInterceptor" />
				<interceptor-ref name="defaultStack" />
			</interceptor-stack>
			<!--拦截token和验证码-->
			<interceptor name="TokenCheckInterceptor"
				class="com.wirich.common.TokenCheckInterceptor"></interceptor>
			<interceptor name="IdentCodeCheckInterceptor"
				class="com.wirich.common.IdentCodeCheckInterceptor"></interceptor>
			<interceptor-stack name="myStack">
				<!-- <interceptor-ref name="IdentCodeCheckInterceptor"></interceptor-ref> --> 
				<interceptor-ref name="TokenCheckInterceptor"></interceptor-ref>
				<interceptor-ref name="defaultStack"></interceptor-ref>
			</interceptor-stack>
		</interceptors>
		<default-interceptor-ref name="wirichJsonInterceptor" />
		<global-results>
			<result name="*" type="json">
				<param name="root">dataMap</param>
				<!-- 指定是否序列化空的属性 -->
				<param name="excludeNullProperties">true</param>
				<param name="contentType">text/html</param>
			</result>
		</global-results>
	</package>
	<include file="sshconfig/struts/*.xml"></include>
	<include file="sshconfig/struts/api/*.xml"></include>
	<include file="sshconfig/struts/r360/*.xml"></include>
</struts>
